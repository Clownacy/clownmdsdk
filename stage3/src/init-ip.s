| Copyright (c) 2024 Clownacy

| Permission to use, copy, modify, and/or distribute this software for any
| purpose with or without fee is hereby granted.

| THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
| REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
| AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
| INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
| LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
| OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
| PERFORMANCE OF THIS SOFTWARE.

	.section  .text.init

	| "US Security Code". Necessary for the BIOS to accept the payload.
        dc.b    0x43,0xFA,0x00,0x0A,0x4E,0xB8,0x03,0x64
        dc.b    0x60,0x00,0x05,0x7A,0x60,0x0F,0x00,0x00
        dc.b    0x00,0x00,0x0C,0x22,0x0E,0x44,0x0E,0x66
        dc.b    0x0E,0x88,0x0E,0xEE,0x0A,0xAA,0x08,0x88
        dc.b    0x04,0x44,0x08,0xAE,0x04,0x6A,0x00,0x0E
        dc.b    0x00,0x08,0x00,0x04,0x0E,0x20,0x80,0x3F
        dc.b    0x80,0x05,0x18,0x15,0x1B,0x26,0x39,0x36
        dc.b    0x38,0x45,0x17,0x54,0x08,0x64,0x09,0x72
        dc.b    0x00,0x83,0x05,0x16,0x86,0x03,0x03,0x16
        dc.b    0x3A,0x89,0x03,0x02,0x15,0x19,0x26,0x3B
        dc.b    0x48,0xF8,0x58,0xFA,0x67,0x7B,0x75,0x1A
        dc.b    0x8A,0x04,0x0A,0x8F,0x07,0x78,0x17,0x79
        dc.b    0x37,0x7A,0xFF,0x00,0x23,0xAE,0x3A,0xCF
        dc.b    0x2F,0x37,0x7E,0x80,0x3F,0xED,0xA3,0xFF
        dc.b    0xE0,0x0E,0xFD,0x71,0xD6,0x79,0x79,0xDB
        dc.b    0xDB,0xF4,0x00,0xC2,0x58,0x00,0x5F,0xAB
        dc.b    0xBB,0x2B,0xBF,0xC2,0xF8,0x00,0xC7,0xF5
        dc.b    0xB0,0xFE,0x9A,0x85,0xFF,0xF0,0x3F,0x8D
        dc.b    0xBF,0xD3,0x63,0xA0,0xBB,0xE1,0x81,0xC3
        dc.b    0xE5,0xED,0xDF,0xAB,0xBD,0xBB,0xBC,0x78
        dc.b    0x5F,0xAF,0xC3,0x45,0xDA,0x00,0xBE,0x61
        dc.b    0x01,0xBD,0x7D,0x61,0x42,0x00,0x9D,0x68
        dc.b    0x17,0x85,0x0D,0x10,0x80,0x2E,0xB1,0xFD
        dc.b    0xF6,0x00,0x03,0xE5,0xFE,0x17,0xCF,0x2E
        dc.b    0xD5,0x15,0x77,0x69,0xAB,0xBB,0x4D,0x5D
        dc.b    0xDA,0x15,0x00,0x18,0xCD,0xD6,0xD5,0xF3
        dc.b    0xCF,0x9C,0x79,0x7E,0x11,0xB7,0xC3,0x00
        dc.b    0x38,0x64,0xB0,0x03,0x97,0xFD,0xF6,0x00
        dc.b    0x02,0x84,0x11,0x98,0xC8,0x00,0x69,0x1D
        dc.b    0x88,0x46,0x43,0x5F,0x00,0x1D,0x84,0x66
        dc.b    0x50,0x0B,0xF9,0xEF,0xC1,0x2C,0x21,0xDA
        dc.b    0x6A,0xEE,0xDB,0xF4,0xA8,0xC5,0xA6,0x80
        dc.b    0x8A,0x9B,0x62,0x96,0xD5,0x2C,0x59,0x6D
        dc.b    0x58,0xC5,0x45,0x59,0x70,0xAC,0x0A,0x17
        dc.b    0xFF,0xC6,0x13,0x67,0x14,0x59,0xDF,0xC7
        dc.b    0xE1,0x58,0x00,0x17,0x7F,0xEF,0x01,0xA2
        dc.b    0x5A,0x96,0xB8,0x7E,0x55,0xD4,0x6B,0x7F
        dc.b    0x40,0x01,0xF5,0xBD,0x42,0x10,0x4A,0x25
        dc.b    0x02,0x09,0x44,0xEB,0x40,0x17,0xEC,0xF8
        dc.b    0xE7,0xE0,0x00,0x58,0x44,0xA9,0x40,0x10
        dc.b    0x8C,0x66,0x10,0x04,0xA7,0xFA,0xF4,0x43
        dc.b    0xB4,0xD1,0x77,0x69,0xA3,0x95,0xE5,0x72
        dc.b    0xA2,0xA6,0xC8,0xBD,0x4D,0x91,0x7A,0x9A
        dc.b    0x40,0x05,0xFF,0x35,0x1F,0x93,0xBA,0xEB
        dc.b    0xF5,0xE6,0xEC,0xE2,0x82,0xCE,0x28,0xE3
        dc.b    0xD6,0x3A,0xF1,0xFB,0x6E,0x56,0x3D,0x80
        dc.b    0x0A,0x75,0xA0,0x00,0xCC,0x64,0x02,0xEA
        dc.b    0x16,0x15,0xF2,0x00,0x22,0x54,0x20,0x02
        dc.b    0x50,0xB8,0xD7,0x3A,0x00,0x21,0x0A,0x32
        dc.b    0x02,0x14,0x66,0x3B,0xBF,0x60,0x04,0x20
        dc.b    0x00,0x21,0x35,0x53,0x57,0x76,0x9A,0x22
        dc.b    0xD3,0x44,0x2E,0x51,0x15,0x36,0x45,0xEA
        dc.b    0x6C,0x88,0xB6,0x6B,0x8B,0x6E,0xDC,0x7E
        dc.b    0xE4,0x00,0x8A,0x5E,0x78,0xA2,0xCE,0x28
        dc.b    0x2C,0xE2,0x8C,0x7B,0xDF,0xB0,0x03,0x1E
        dc.b    0xCD,0x00,0x1A,0x8D,0x00,0x1B,0xD6,0x89
        dc.b    0x44,0x27,0x74,0xF8,0xCB,0xDF,0x7D,0x71
        dc.b    0x9F,0xE7,0x80,0xD4,0xB5,0x2F,0x31,0xD7
        dc.b    0x6F,0xD7,0x66,0x11,0x2D,0x4B,0x52,0xF3
        dc.b    0x1D,0x67,0x0F,0xD7,0xEE,0x40,0x08,0xD6
        dc.b    0x80,0x03,0x4A,0xD8,0xF8,0xC5,0x97,0x08
        dc.b    0xAB,0xD6,0x2C,0xB8,0xB1,0x0B,0x9F,0xDC
        dc.b    0xF3,0xEE,0xD3,0x40,0x06,0xB1,0xFE,0x60
        dc.b    0xB3,0x8A,0x2C,0xE2,0xA3,0x30,0x80,0x14
        dc.b    0x80,0x03,0x01,0x14,0x04,0x25,0x0E,0x35
        dc.b    0x18,0x45,0x13,0x56,0x39,0x67,0x79,0x75
        dc.b    0x14,0x81,0x03,0x00,0x16,0x2F,0x27,0x78
        dc.b    0x82,0x04,0x05,0x16,0x36,0x83,0x05,0x0C
        dc.b    0x16,0x37,0x28,0xF9,0x84,0x05,0x15,0x17
        dc.b    0x7B,0x85,0x05,0x16,0x86,0x05,0x0D,0x16
        dc.b    0x3A,0x87,0x05,0x0F,0x17,0x76,0x88,0x05
        dc.b    0x10,0x18,0xFA,0x89,0x06,0x2E,0x8A,0x06
        dc.b    0x32,0x18,0xF8,0x8B,0x05,0x11,0x17,0x7A
        dc.b    0x8C,0x06,0x38,0x8D,0x05,0x1A,0x8E,0x06
        dc.b    0x33,0x17,0x77,0x8F,0x05,0x12,0xFF,0xA5
        dc.b    0x28,0x9B,0x26,0xF8,0x5A,0xF6,0x70,0x6A
        dc.b    0x07,0x3C,0xDE,0xE0,0x6F,0x21,0x19,0x5B
        dc.b    0x56,0xD5,0x77,0xFC,0xFF,0xEE,0xEF,0xCF
        dc.b    0xA0,0x49,0x7F,0x04,0xC8,0x60,0x10,0xEF
        dc.b    0x07,0xBD,0xFF,0xD4,0xF5,0x4F,0x99,0xF8
        dc.b    0xDF,0x9B,0xD9,0x3D,0x98,0xED,0xA6,0x37
        dc.b    0x9E,0xE6,0xD5,0xB5,0x6C,0x58,0x59,0xFB
        dc.b    0x14,0x6A,0x3C,0x8C,0x55,0x18,0x43,0x10
        dc.b    0x79,0xDD,0xCC,0xE5,0x7B,0x9B,0xB4,0x6B
        dc.b    0x6C,0xF5,0x6E,0x21,0x61,0xF2,0x1E,0x8C
        dc.b    0x73,0x1B,0x8E,0xD4,0xA3,0x84,0xDB,0x8E
        dc.b    0xCC,0x20,0xFE,0xD5,0xAC,0xD8,0xF8,0x3B
        dc.b    0xCE,0xF4,0x13,0x0A,0x9B,0x65,0x5D,0x93
        dc.b    0x6C,0xF9,0xA9,0xCD,0xD6,0xAF,0x78,0x22
        dc.b    0xBF,0x5F,0x99,0x1F,0x09,0x1C,0xBD,0x4D
        dc.b    0xA3,0x9D,0x35,0xF7,0xE3,0xF3,0xBD,0x3B
        dc.b    0xD6,0x9A,0xF4,0x89,0xE8,0x38,0x1D,0x3B
        dc.b    0xAE,0x06,0x47,0xEB,0xF5,0x95,0x9F,0xBB
        dc.b    0x0B,0x8B,0x07,0xE5,0x7F,0x33,0xF3,0xD4
        dc.b    0x12,0x2C,0xB7,0x68,0x78,0x83,0x50,0x41
        dc.b    0xED,0xF3,0x98,0x8E,0xB8,0x5D,0x28,0x8E
        dc.b    0x5E,0x26,0x0E,0x72,0x05,0x4E,0x64,0x67
        dc.b    0x67,0x4B,0xBD,0xB0,0x25,0x97,0xEC,0x8E
        dc.b    0xAC,0xB3,0xBF,0x98,0xAF,0xC7,0xAF,0x84
        dc.b    0xCB,0x86,0x10,0x8F,0x39,0x85,0x20,0x88
        dc.b    0x77,0x0A,0xD2,0xDC,0xDD,0x74,0x91,0xA2
        dc.b    0x50,0x2A,0xE7,0xC0,0xC2,0xEC,0x69,0xF9
        dc.b    0xC7,0xF5,0x51,0xBA,0xD1,0xBB,0x0F,0x32
        dc.b    0x89,0xBE,0x00,0xB0,0xBE,0x17,0x03,0xB9
        dc.b    0x90,0x46,0x04,0xE9,0x77,0x3B,0x04,0x63
        dc.b    0x95,0x2E,0x31,0x73,0xDB,0x15,0xB9,0xCA
        dc.b    0x8B,0x3F,0xD1,0x52,0x94,0xA5,0x3C,0xFE
        dc.b    0x75,0xED,0x5C,0x0C,0x86,0x5C,0xC9,0xAE
        dc.b    0xD0,0xB3,0x66,0xC6,0xB2,0x09,0xF9,0xDD
        dc.b    0x86,0x49,0x7F,0x3F,0xDC,0x5F,0x77,0x63
        dc.b    0x2B,0xCC,0x1A,0x92,0xD7,0x03,0xBB,0xD3
        dc.b    0xF3,0xF9,0x89,0x5D,0xA1,0x97,0xAF,0x86
        dc.b    0x11,0x1F,0xE8,0xC4,0x65,0x81,0xC3,0xDB
        dc.b    0xFB,0xCD,0x52,0x94,0xA6,0xA9,0x4F,0x3A
        dc.b    0xF3,0x5F,0xD2,0xFB,0xDC,0x7C,0x87,0xA3
        dc.b    0x1C,0xC6,0xE3,0xB5,0x1C,0x29,0x36,0xE3
        dc.b    0xB3,0x08,0x3F,0xB5,0x6B,0x36,0x3E,0x0E
        dc.b    0xF3,0xBD,0x04,0xC2,0xD6,0xDF,0xD2,0x4D
        dc.b    0xA7,0x24,0x5A,0x63,0x3A,0xFD,0x45,0x5B
        dc.b    0xFA,0xCA,0xA6,0x49,0xEE,0xC2,0xE9,0x5F
        dc.b    0xF9,0x5F,0xCC,0xB2,0x43,0xA8,0x24,0x6E
        dc.b    0x1D,0xA1,0x79,0xC9,0xA8,0x20,0xF0,0x5F
        dc.b    0x36,0x9E,0x17,0x88,0x5C,0xD9,0x47,0x24
        dc.b    0xAC,0xC4,0xB0,0xA7,0xB8,0x9E,0x61,0xEB
        dc.b    0x8C,0xE4,0x9F,0xA2,0x22,0x3C,0xD7,0xCF
        dc.b    0xD6,0x51,0xAA,0xE9,0x70,0xF3,0x25,0x37
        dc.b    0xC0,0x16,0x17,0xC2,0xE0,0x77,0x32,0x08
        dc.b    0xC0,0x9D,0x2E,0xE7,0x60,0x8C,0x72,0xA5
        dc.b    0xC6,0x2E,0x00,0x00,0x06,0x03,0x00,0x00
        dc.b    0x00,0x01,0x05,0x10,0x12,0xC2,0x04,0x88
        dc.b    0x50,0x11,0x04,0x80,0x14,0x05,0x10,0x9A
        dc.b    0x21,0x54,0x42,0x60,0x05,0x05,0x01,0x34
        dc.b    0x38,0x11,0x40,0x51,0x11,0x81,0x14,0x04
        dc.b    0x01,0x10,0x20,0xC5,0x05,0x01,0x5C,0x58
        dc.b    0x02,0x20,0x40,0x1F,0x02,0x00,0x88,0x10
        dc.b    0x07,0xC3,0x80,0xC8,0x04,0x01,0xA1,0x38
        dc.b    0xB4,0x94,0x01,0x00,0xAC,0x58,0x0E,0x20
        dc.b    0x40,0x1A,0x13,0x93,0xB1,0xA9,0xA8,0x1C
        dc.b    0x5D,0x8D,0x42,0xE2,0x68,0x6C,0x0F,0xF0
        dc.b    0x05,0x00,0x00,0x00,0x00,0x00,0x39,0x0A
        dc.b    0x41,0x06,0x01,0x81,0x80,0x90,0x29,0xAF
        dc.b    0xF8,0x50,0x52,0x4F,0x44,0x55,0x43,0x45
        dc.b    0x44,0x20,0x42,0x59,0x20,0x4F,0x52,0x20
        dc.b    0x55,0x4E,0x44,0x45,0x52,0x20,0x4C,0x49
        dc.b    0x43,0x45,0x4E,0x53,0x45,0x00,0x00,0x20
        dc.b    0x46,0x52,0x4F,0x4D,0x20,0x53,0x45,0x47
        dc.b    0x41,0x20,0x45,0x4E,0x54,0x45,0x52,0x50
        dc.b    0x52,0x49,0x53,0x45,0x53,0x2C,0x20,0x4C
        dc.b    0x54,0x44,0x2E,0xFF,0x14,0x11,0x08,0x0D
        dc.b    0x17,0x11,0x00,0x0D,0x14,0x11,0x14,0x11
        dc.b    0x90,0x00,0x00,0x00,0x00,0x1C,0x14,0x11
        dc.b    0x80,0x80,0x80,0x1D,0x11,0x00,0x00,0x00
        dc.b    0x00,0xAE,0x11,0x07,0x00,0x01,0x00,0xAD
        dc.b    0x11,0x00,0x00,0x3F,0x11,0x00,0x0B,0x48
        dc.b    0x11,0x00,0x0B,0x66,0x11,0x00,0x0B,0x84
        dc.b    0x11,0x00,0x0B,0x93,0x11,0x00,0x0B,0xA2
        dc.b    0x11,0x00,0x0B,0xEF,0x01,0xE0,0x80,0x80
        dc.b    0x0A,0xC9,0x0C,0xF2,0x80,0x05,0x80,0x39
        dc.b    0x80,0x05,0x80,0x0C,0xEF,0x00,0xF0,0x0A
        dc.b    0x01,0x02,0x08,0xA9,0x1F,0x80,0x01,0xA5
        dc.b    0x40,0xE7,0xA5,0x02,0xF7,0x00,0x08,0x5D
        dc.b    0x11,0xF2,0x80,0x05,0x80,0x39,0x80,0x05
        dc.b    0x80,0x0C,0xEF,0x00,0xF0,0x0A,0x01,0x02
        dc.b    0x08,0xB8,0x1F,0x80,0x01,0xB5,0x40,0xE7
        dc.b    0xB5,0x02,0xF7,0x00,0x08,0x7B,0x11,0xF2
        dc.b    0xEF,0x01,0xE0,0x80,0x80,0x05,0xC4,0x0C
        dc.b    0xE0,0x40,0x80,0x05,0xC4,0x39,0xF2,0xEF
        dc.b    0x01,0xE0,0x80,0x80,0x0A,0x80,0x07,0xE0
        dc.b    0x40,0x80,0x0A,0xC9,0x34,0xF2,0xEF,0x01
        dc.b    0xE0,0x80,0xC1,0x12,0xE0,0x40,0xC1,0x3F
        dc.b    0xF2,0xF2,0x32,0x01,0x01,0x01,0x01,0x3F
        dc.b    0x1F,0x1F,0x1F,0x19,0x06,0x04,0x07,0x08
        dc.b    0x05,0x05,0x04,0x19,0x19,0x19,0x19,0x11
        dc.b    0x89,0x18,0x87,0x04,0x37,0x72,0x77,0x49
        dc.b    0x1F,0x1F,0x1F,0x1F,0x07,0x0A,0x07,0x0D
        dc.b    0x00,0x0B,0x00,0x0B,0x1F,0x0F,0x1F,0x0F
        dc.b    0x23,0x80,0x23,0x80

	.include "clear-bss.s"

	| Fall-through to the compiled code...
